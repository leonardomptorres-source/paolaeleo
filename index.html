<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Paola e Leo</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: "Montserrat", 'Poppins', sans-serif;
      display: flex; justify-content: center; align-items: center;
      height: 100vh; margin: 0; background: #fdfdfd;
    }
    .card {
      background: white; border-radius: 20px; box-shadow: 0 6px 12px rgba(0,0,0,0.1);
      width: 90%; max-width: 500px; padding: 30px; text-align: center;
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px);} to {opacity: 1; transform: translateY(0);} }
    button {
      background: #e91e63; color: white; border: none; padding: 10px 20px;
      border-radius: 10px; cursor: pointer; margin-top: 20px; font-size: 16px;
    }
    button:disabled { background: #ccc; cursor: not-allowed; }
    .option { margin: 10px 0; }
    .progress { height: 10px; background: #eee; border-radius: 5px; margin-top: 20px; }
    .bar { height: 100%; background: #e91e63; border-radius: 5px; transition: width 0.3s; }
    ul { list-style: none; padding: 0; }
    li { margin: 5px 0; }
	
	input[type=text] { padding: 3px 10px; border: 3px solid #e1e1e1; height: 38px }
	.m-r-10 { margin-right: 10px }
  </style>
</head>
<body>
  <div id="app">
    <div class="card" v-if="stage === 'start'">
      <h2>Bem-vindo ao Quiz do Casal üíï</h2>
      <p>Digite seu nome para come√ßar:</p>
      <input type="text" v-model="nome" placeholder="Seu nome" class="m-r-10" style="width: 300px" />
      <button @click="next" :disabled="!nome">Come√ßar</button>
    </div>

    <div class="card" v-else-if="stage === 'quiz'">
      <div class="progress">
        <div class="bar" :style="{width: progress + '%'}"></div>
      </div>
      <h3>{{ currentQuestion.text }}</h3>
      <div v-for="option in currentQuestion.options" :key="option" class="option">
        <label><input type="radio" :value="option" v-model="answer" /> {{ option }}</label>
      </div>
      <button @click="sendAnswer" :disabled="!answer">Pr√≥xima</button>
    </div>

    <div class="card" v-else-if="stage === 'ranking'">
      <h2>üèÜ Ranking Final</h2>
      <ul>
        <li v-for="(item, index) in ranking" :key="item.nome">
          <strong>{{ index + 1 }}¬∫</strong> {{ item.nome }} ‚Äî {{ item.pontos }} pontos
        </li>
      </ul>
    </div>
  </div>

  <script>
  const { createApp } = Vue;

  createApp({
    data() {
      return {
        nome: "",
        currentIndex: 0,
        answer: "",
        stage: "start",
        questions: [
          { text: "Qual a cor favorita do casal?", options: ["Azul", "Verde", "Vermelho", "Amarelo"], answer: 1 },
          { text: "Em que cidade se conheceram?", options: ["Rio", "SP", "BH", "Salvador"], answer: 1 },
          // adicione at√© 20 perguntas...
        ],
        googleScriptURL: "https://script.google.com/macros/s/1GOEziUaLjeZOnFCO1RMvhNT_zIrLKHOoZcO489lduqdve6otQ_o6Pro8/exec",
        ranking: []
      };
    },
    computed: {
      currentQuestion() { return this.questions[this.currentIndex]; },
      progress() { return ((this.currentIndex + 1) / this.questions.length) * 100; }
    },
    methods: {
      async next() {
        this.stage = 'quiz';
      },
      async sendAnswer() {
        const q = this.currentQuestion;
        const payload = {
          nome: this.nome,
          pergunta: q.text,
          resposta: this.answer
        };
        await fetch(this.googleScriptURL, {
          method: "POST",
          body: JSON.stringify(payload),
          headers: { "Content-Type": "application/json" }
        });

        this.answer = "";
        this.currentIndex++;

        if (this.currentIndex >= this.questions.length) {
          await this.finishQuiz();
        }
      },
      async finishQuiz() {
        const res = await fetch(this.googleScriptURL, {
          method: "POST",
          body: JSON.stringify({ nome: this.nome, finalizar: true }),
          headers: { "Content-Type": "application/json" }
        });
        const data = await res.json();
        this.ranking = data.ranking || [];
        this.stage = "ranking";
      }
    }
  }).mount("#app");
  </script>
</body>
</html>
